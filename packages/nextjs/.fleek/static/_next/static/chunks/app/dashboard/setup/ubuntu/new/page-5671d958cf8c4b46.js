(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7862],{45472:function(e,s,t){Promise.resolve().then(t.bind(t,14349))},14349:function(e,s,t){"use strict";t.r(s),t.d(s,{default:function(){return v}});var a=t(57437),r=t(2265),l=t(99376),n=e=>{let{steps:s}=e,t=s.length,r=s.filter(e=>"completed"===e.status).length;return(0,a.jsx)("div",{className:"w-full bg-gray-200 dark:bg-base-200 rounded-full h-2 mb-6",children:(0,a.jsx)("div",{className:"bg-primary h-2 rounded-full transition-all duration-500",style:{width:"".concat(r/t*100,"%")}})})},c=t(37996),i=e=>{let{status:s}=e;switch(s){case"running":return(0,a.jsx)(c.dAq,{className:"animate-spin text-primary"});case"completed":return(0,a.jsx)(c.UgA,{className:"text-success"});case"error":return(0,a.jsx)(c.q5L,{className:"text-error"});default:return(0,a.jsx)(c.cDN,{className:"text-base-content/50"})}},o=t(44794),d=t(64935),u=t(50091),m=t(98728),p=t(42488),h=t(80221),x=t(64707),g=e=>{let{isOpen:s,onSubmit:t,onClose:r}=e;return(0,a.jsxs)("dialog",{className:"modal ".concat(s?"modal-open":""),children:[(0,a.jsxs)("div",{className:"modal-box bg-base-100 text-base-content",children:[(0,a.jsx)("h3",{className:"font-bold text-lg mb-4",children:"Enter Sudo Password"}),(0,a.jsxs)("form",{onSubmit:e=>{e.preventDefault(),t(new FormData(e.currentTarget).get("password"))},children:[(0,a.jsxs)("div",{className:"form-control",children:[(0,a.jsx)("label",{className:"label",children:(0,a.jsx)("span",{className:"label-text",children:"Password"})}),(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)(c.UIZ,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-base-content/50"}),(0,a.jsx)("input",{type:"password",name:"password",className:"input input-bordered pl-10 w-full",placeholder:"Enter your sudo password",required:!0})]}),(0,a.jsx)("label",{className:"label",children:(0,a.jsx)("span",{className:"label-text-alt text-base-content/70",children:"Your password is required for system-level operations"})})]}),(0,a.jsxs)("div",{className:"modal-action",children:[(0,a.jsx)("button",{type:"submit",className:"btn btn-primary",children:"Continue"}),(0,a.jsx)("button",{type:"button",className:"btn btn-ghost",onClick:r,children:"Cancel"})]})]})]}),(0,a.jsx)("form",{method:"dialog",className:"modal-backdrop",children:(0,a.jsx)("button",{onClick:r,children:"Close"})})]})},b=t(15488);let j=[{command:"echo $PASSWORD | sudo -S apt update",description:"Updating package lists",category:"System Updates",status:"pending"},{command:"echo $PASSWORD | sudo -S apt upgrade -y",description:"Upgrading installed packages",category:"System Updates",status:"pending"},{command:"echo $PASSWORD | sudo -S apt install curl -y",description:"Installing curl",category:"System Updates",status:"pending"},{command:"curl -o- https://raw.githubusercontent.com/nvm-sh/nvm/v0.39.0/install.sh | bash",description:"Installing NVM",category:"Node.js Setup",status:"pending"},{command:" nvm install --lts",description:"Installing Node.js LTS",category:"Node.js Setup",status:"pending"},{command:"echo $PASSWORD | sudo -S apt install git -y",description:"Installing Git",category:"Development Tools",status:"pending"},{command:"npm install --global yarn",description:"Installing Yarn",category:"Development Tools",status:"pending"},{command:"npm install --global pm2",description:"Installing PM2",category:"Development Tools",status:"pending"},{command:"git clone https://github.com/BuidlGuidl/buidlguidl-client.git",description:"Cloning Repository",category:"Project Setup",status:"pending"},{command:"cd $DIRECTORY && yarn install",description:"Installing Dependencies",category:"Project Setup",status:"pending"},{command:"cd $DIRECTORY && pm2 start index.js -- --owner $ADDRESS",description:"Starting PM2 Service",category:"Project Setup",status:"pending"}],N=e=>{switch(e){case"System Updates":return(0,a.jsx)(o.Z,{className:"h-5 w-5"});case"Node.js Setup":return(0,a.jsx)(d.Z,{className:"h-5 w-5"});default:return(0,a.jsx)(u.Z,{className:"h-5 w-5"})}};function v(){let e=(0,l.useRouter)(),{address:s}=(0,x.m)(),[t,o]=(0,r.useState)(j),[d,u]=(0,r.useState)(-1),[v,f]=(0,r.useState)(!1),[y,S]=(0,r.useState)(!1),[w,D]=(0,r.useState)(!1),C=t.reduce((e,s)=>{let t=s.category||"Uncategorized";return e[t]||(e[t]=[]),e[t].push(s),e},{}),P=()=>{try{let e=localStorage.getItem(b.Bm);return e?JSON.parse(e):null}catch(e){return console.error("Error loading saved progress:",e),null}},k=(e,s)=>{try{localStorage.setItem(b.Bm,JSON.stringify({steps:e,currentStep:s}))}catch(e){console.error("Error saving progress:",e)}};(0,r.useEffect)(()=>{let e=P();if(e){var s,t;let{steps:a,currentStep:r}=e,l=j.map((e,s)=>{let t=a[s];return t?{...e,status:t.status,output:t.output}:e});o(l),u(r),(null===(s=l[r])||void 0===s?void 0:s.status)==="error"&&S(!0),(null===(t=l[r])||void 0===t?void 0:t.status)==="running"&&f(!0)}},[]);let I=async e=>{D(!1),await R(e)},R=async e=>{f(!0),S(!1);let a=Math.max(d,0),r=d;for(let l=a;l<t.length;l++){r=l,u(l),o(e=>e.map((e,s)=>s===l?{...e,status:"running"}:s<l?{...e,status:"completed"}:e));try{if(t[l].skip)continue;let a=await (0,b.P0)(t[l].command,"~/buidlguidl-client",s,e);if(a.error){o(e=>{let s=e.map((e,s)=>s===l?{...e,status:"error",output:a.error}:e);return k(s,l),s}),S(!0);break}o(e=>{let s=e.map((e,s)=>s===l?{...e,status:"completed",output:a.output}:e);return k(s,l),s})}catch(e){o(s=>{let t=s.map((s,t)=>t===l?{...s,status:"error",output:e.message||"Command failed"}:s);return k(t,l),t}),S(!0);break}}f(!1),y||r!==t.length-1||(localStorage.removeItem(b.Bm),console.log("Setting setup completed to true"),localStorage.setItem(b.Iy,"true"),localStorage.setItem(b.s6,b.Ko))},O=()=>{D(!0)};return(0,a.jsxs)("div",{className:"min-h-screen bg-base-200",children:[(0,a.jsxs)("div",{className:"navbar bg-base-100 shadow-lg px-6",children:[(0,a.jsx)("div",{className:"flex-1",children:(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)(m.Z,{className:"h-6 w-6 text-primary"}),(0,a.jsx)("h1",{className:"text-xl font-bold",children:"Node Setup Dashboard"})]})}),(0,a.jsxs)("div",{className:"flex-none",children:[(0,a.jsx)(p.Z,{className:"h-5 w-5 text-success animate-pulse"}),(0,a.jsxs)("span",{className:"ml-2 text-sm",children:["Status: ",v?"Running":"Ready"]})]})]}),(0,a.jsxs)("div",{className:"container mx-auto p-6",children:[(0,a.jsxs)("div",{className:"grid grid-cols-1 xl:grid-cols-3 gap-6 mb-6",children:[(0,a.jsx)("div",{className:"xl:col-span-2",children:(0,a.jsx)("div",{className:"card bg-base-100 shadow-xl",children:(0,a.jsxs)("div",{className:"card-body",children:[(0,a.jsx)("h2",{className:"card-title text-lg mb-4",children:"Overall Progress"}),(0,a.jsx)(n,{steps:t})]})})}),(0,a.jsx)("div",{className:"xl:col-span-1",children:(0,a.jsx)("div",{className:"card bg-base-100 shadow-xl",children:(0,a.jsxs)("div",{className:"card-body",children:[(0,a.jsx)("h2",{className:"card-title text-lg mb-4",children:"Controls"}),!v&&-1===d&&(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"alert alert-info bg-info/10 border border-info",children:[(0,a.jsx)(c.BJv,{className:"h-5 w-5"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"font-bold",children:"Prerequisites"}),(0,a.jsx)("p",{className:"text-sm",children:"Sudo access and stable internet required"})]})]}),(0,a.jsxs)("button",{onClick:O,className:"btn btn-primary w-full gap-2",children:[(0,a.jsx)(h.Z,{className:"h-4 w-4"}),"Start Setup Process"]})]}),!v&&y&&(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"alert alert-error bg-error/10 border border-error",children:[(0,a.jsx)(c.q5L,{className:"h-5 w-5"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"font-bold",children:"Setup Failed"}),(0,a.jsx)("p",{className:"text-sm",children:"Please check errors and retry"})]})]}),(0,a.jsx)("button",{onClick:O,className:"btn btn-error w-full",children:"Retry Setup"})]}),!v&&!y&&d>=0&&d===t.length-1&&(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"alert alert-success bg-success/10 border border-success",children:[(0,a.jsx)(c.UgA,{className:"h-5 w-5"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"font-bold",children:"Setup Complete"}),(0,a.jsx)("p",{className:"text-sm",children:"Node configured successfully"})]})]}),(0,a.jsx)("button",{onClick:()=>e.push("/dashboard/setup/ubuntu"),className:"btn btn-success w-full",children:"Go to Dashboard"})]})]})})})]}),(0,a.jsx)("div",{className:"space-y-6",children:Object.entries(C).map(e=>{let[s,t]=e;return(0,a.jsx)("div",{className:"card bg-base-100 shadow-xl",children:(0,a.jsxs)("div",{className:"card-body",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3 mb-6",children:[N(s),(0,a.jsx)("h2",{className:"card-title text-lg",children:s}),(0,a.jsx)("div",{className:"flex-1"}),(0,a.jsxs)("div",{className:"badge badge-lg",children:[t.filter(e=>"completed"===e.status).length,(0,a.jsx)("span",{className:"mx-1",children:"/"}),t.length]})]}),(0,a.jsx)("div",{className:"space-y-4",children:t.map((e,s)=>(0,a.jsx)("div",{className:"rounded-lg border-2 transition-all duration-300 ".concat("running"===e.status?"border-primary bg-primary/5":"completed"===e.status?"border-success bg-success/5":"error"===e.status?"border-error bg-error/5":"border-base-300"),children:(0,a.jsxs)("div",{className:"p-4",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)(i,{status:e.status}),(0,a.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,a.jsx)("h4",{className:"font-medium truncate",children:e.description}),(0,a.jsx)("code",{className:"text-xs opacity-70 block truncate",children:e.command})]}),(0,a.jsx)("span",{className:"badge ".concat("running"===e.status?"badge-primary":"completed"===e.status?"badge-success":"error"===e.status?"badge-error":"badge-ghost"),children:e.status})]}),e.output&&(0,a.jsx)("div",{className:"mt-3",children:(0,a.jsx)("div",{className:"bg-base-300 rounded-lg p-3 max-h-32 overflow-y-auto",children:(0,a.jsx)("pre",{className:"text-xs whitespace-pre-wrap",children:e.output})})})]})},s))})]})},s)})})]}),(0,a.jsx)(g,{isOpen:w,onSubmit:I,onClose:()=>D(!1)})]})}},15488:function(e,s,t){"use strict";t.d(s,{$H:function(){return c},Bm:function(){return n},Iy:function(){return l},Ko:function(){return i},LU:function(){return a},P0:function(){return o},s6:function(){return r}});let a="ssh_server_details",r="buidlguidlDirectory",l="buidlguidlSetupCompleted",n="setupProgress",c="ssh_remember_me",i="~/buidlguidl-client",o=async(e,s,t,a)=>{let r=e.replace("$DIRECTORY",s).replace("$ADDRESS",t||"").replace("$PASSWORD",a||"");try{let e=await fetch("/api/ssh/execute",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({command:r})}),s=await e.json();if(s.error)throw Error(s.message||"Command execution failed");return s}catch(e){throw e}}}},function(e){e.O(0,[9956,4707,8488,2971,2117,1744],function(){return e(e.s=45472)}),_N_E=e.O()}]);